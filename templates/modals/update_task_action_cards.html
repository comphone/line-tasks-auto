<div class="card shadow mb-4">
    <div class="card-header py-3">
        <h6 class="m-0 font-weight-bold text-primary"><i class="fas fa-cogs me-2"></i>เมนูจัดการงาน</h6>
    </div>
    <div class="card-body">
        <div class="accordion" id="actionAccordion">

            <div class="accordion-item">
                <h2 class="accordion-header" id="headingOne">
                    <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseOne" aria-expanded="false" aria-controls="collapseOne">
                        <i class="fas fa-check-circle text-success me-2"></i> ปิดงาน / ส่งงาน
                    </button>
                </h2>
                <div id="collapseOne" class="accordion-collapse collapse" aria-labelledby="headingOne" data-bs-parent="#actionAccordion">
                    <div class="accordion-body">
                        <form id="complete-task-form">
                            <div class="mb-3">
                                <label for="work_summary" class="form-label">สรุปการทำงาน</label>
                                <textarea class="form-control" id="work_summary" name="work_summary" rows="3" required></textarea>
                            </div>
                            {% include 'modals/attachment_uploader.html' %}
                            <button type="submit" class="btn btn-success w-100">ยืนยันการปิดงาน</button>
                        </form>
                    </div>
                </div>
            </div>

            <div class="accordion-item">
                <h2 class="accordion-header" id="headingTwo">
                    <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo">
                       <i class="fas fa-calendar-alt text-warning me-2"></i> เลื่อนนัดหมาย
                    </button>
                </h2>
                <div id="collapseTwo" class="accordion-collapse collapse" aria-labelledby="headingTwo" data-bs-parent="#actionAccordion">
                    <div class="accordion-body">
                        <form id="reschedule-task-form">
                           <div class="mb-3">
                                <label for="reschedule_due" class="form-label">วัน-เวลาที่นัดหมายใหม่</label>
                                <input type="datetime-local" class="form-control" id="reschedule_due" name="reschedule_due" required>
                            </div>
                            <div class="mb-3">
                                <label for="reschedule_reason" class="form-label">เหตุผลที่เลื่อน</label>
                                <textarea class="form-control" id="reschedule_reason" name="reschedule_reason" rows="2" required></textarea>
                            </div>
                            <button type="submit" class="btn btn-warning w-100">ยืนยันการเลื่อนนัด</button>
                        </form>
                    </div>
                </div>
            </div>

            <div class="accordion-item">
                <h2 class="accordion-header" id="headingThree">
                    <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseThree" aria-expanded="false" aria-controls="collapseThree">
                       <i class="fas fa-file-alt text-info me-2"></i> บันทึกความคืบหน้า
                    </button>
                </h2>
                <div id="collapseThree" class="accordion-collapse collapse" aria-labelledby="headingThree" data-bs-parent="#actionAccordion">
                    <div class="accordion-body">
                        <form id="save-report-form">
                           <div class="mb-3">
                                <label for="progress_summary" class="form-label">รายงานความคืบหน้า</label>
                                <textarea class="form-control" id="progress_summary" name="work_summary" rows="3"></textarea>
                            </div>
                            {% include 'modals/attachment_uploader.html' %}
                            <div class="form-check mb-3">
                                <input class="form-check-input" type="checkbox" name="is_internal_note" id="is_internal_note">
                                <label class="form-check-label" for="is_internal_note">
                                    เป็นบันทึกภายใน (ไม่แสดงให้ลูกค้าเห็น)
                                </label>
                            </div>
                            <button type="submit" class="btn btn-info w-100">บันทึกรายงาน</button>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>